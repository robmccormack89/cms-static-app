{% extends "archive.twig" %}

{% block styles %}
  {{ parent() }}
  <style>
    img.uk-height-large {
      height: 400px;
    }
    @media only screen and (max-width: 767px) {
      img.uk-height-large {
        height: 200px;
      }
    }
    
    .uk-subnav>*>:first-child {
      font-size: 1rem;
      font-weight: 500;
      line-height: 1.785;
    }
    .uk-subnav-divider>:nth-child(n+2):not(.uk-first-column):before {
      content: "/";
    }
    .uk-subnav-divider>:before {
      border: none;
      content: none;
      height: 1.5em;
      margin-left: 0;
      margin-right: 20px;
    }
    .uk-subnav {
      margin-left: -25px;
    }
    .uk-subnav>* {
      padding-left: 25px;
    }
    
    .uk-subnav>*>:first-child {
      color: #1a191d;
    }
    .uk-light .uk-subnav>*>:first-child {
      color: #fff;
    }
    .uk-subnav>.uk-active>a,
    .uk-light .uk-subnav>.uk-active>a {
      color: #d90a2c;
    }
    .uk-subnav>*>a:focus, .uk-subnav>*>a:hover,
    .uk-light .uk-subnav>*>a:focus, .uk-light .uk-subnav>*>a:hover {
      color: #d90a2c;
    }
    .small-count.uk-position-top-right {
      top: -5px;
      right: -15px;
      font-size: 12px;
    }
  </style>
{% endblock %}

{% block archive_content %}
  <!-- filters form -->
  <form method="GET" action="/portfolio" id="ArchiveFilters">
    {% for key, val in get %}
      {% if key == 'show_all' %}
        <input type="hidden" name="{{key|escape}}" />
      {% endif %}
      {% if key != 'url' and key != 'show_all' and key != 'technologies' %}
        <input type="hidden" name="{{key|escape}}" value="{{val|escape}}" />
      {% endif %}
    {% endfor %}
  </form>
  <!-- mobile filters form -->
  <form method="GET" action="/portfolio" id="ArchiveFiltersMobile">
    {% for key, val in get %}
      {% if key == 'show_all' %}
        <input type="hidden" name="{{key|escape}}" />
      {% endif %}
      {% if key != 'url' and key != 'show_all' and key != 'technologies' %}
        <input type="hidden" name="{{key|escape}}" value="{{val|escape}}" />
      {% endif %}
    {% endfor %}
  </form>
  <!-- blog toolbar -->
  <nav class="archive-toolbar uk-grid uk-grid-match uk-flex uk-flex-middle uk-grid-collapse" uk-grid>
    <div class="blog-breads uk-width-expand">
      {% include 'breads.twig' %}
    </div>
    <div class="blog-filters uk-width-auto">
      <div class="filter-button uk-hidden@m" uk-grid>
        <a href="#offcanvas-usage" uk-toggle class="uk-button uk-button-secondary uk-border-rounded uk-button-small uk-text-capitalize"><i class="fas fa-filter"></i> Filter</a>
        <div id="offcanvas-usage" uk-offcanvas="overlay: true">
          <div class="uk-offcanvas-bar">
            <a class="uk-offcanvas-close uk-padding-remove"><i class="fas fa-times"></i></a>
            <ul class="uk-nav uk-nav-default">
              <li class="uk-nav-header uk-text-bold">
                {% if archive.pagination.results %}
                  {{archive.pagination.results}}
                {% endif %}
              </li>
              <li class="uk-margin-small">
                <div class="tags-dropdown">
                  <div class="select-inline">
                    <div class="select-holder">
                      {% set technologies = get_terms('technology') %}
                      <select class="uk-select uk-border-rounded" name="technologies" id="technologies" autocomplete="off" form="ArchiveFiltersMobile" onchange="this.form.submit();">
                        <option {% if get.technologies == '' and technology.slug not in get.url %}selected{% endif %} disabled hidden>Technologies</option>
                        {% for technology in technologies %}
                          {% if technology.posts_count > 0  %}
                            <option value="{{technology.slug}}" {% if get.technologies == technology.slug or technology.slug in get.url %}selected{% endif %}>{{technology.title}}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                    </div>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="desktop-filters uk-grid-match uk-flex uk-flex-middle uk-grid-small uk-visible@m uk-margin-remove" uk-grid>
        <div class="results-count uk-width-auto">
          <p class="uk-text-bold uk-text-emphasis uk-text-small">
            {% if archive.pagination.results %}
              {{archive.pagination.results}}
            {% endif %}
          </p>
        </div>
        <div class="tags-dropdown uk-width-auto">
          <div class="select-inline">
            <div class="select-holder">
              {% set technologies = get_terms('technology') %}
              <select class="uk-select uk-border-rounded" name="technologies" id="technologies" autocomplete="off" form="ArchiveFilters" onchange="this.form.submit();">
                <option {% if get.technologies == '' %}selected{% endif %} disabled hidden>Technologies</option>
                {% for technology in technologies %}
                  {% if technology.posts_count > 0  %}
                    <option value="{{technology.slug}}" {% if get.technologies == technology.slug or technology.slug in get.url %}selected{% endif %}>{{technology.title}}</option>
                  {% endif %}
                {% endfor %}
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>
  
  <div class="archive-main portfolio" data-template="portfolio.twig" data-template-extends="archive.twig" uk-filter="target: .posts-grid">
    
    {% if archive.posts %}
      <div class="portfolio-tech-filters uk-margin-medium uk-margin-medium-top" uk-grid>
      <div class="uk-width-auto uk-flex uk-flex-middle">Filter by</div>
      <div class="uk-width-expand">
        <ul class="uk-subnav uk-subnav-divider">
          <li class="uk-active uk-inline" uk-filter-control><a class="uk-text-capitalize" href="#">All<span class="small-count uk-position-top-right">{{ (archive.pagination.results_count < 10) ? 0 : '' }}{{ (archive.pagination.results_count) ? archive.pagination.results_count : '' }}</span></a></li>
          {% set filter_technologies = get_terms('technology') %}
          {% for tech in filter_technologies %}
            {% if tech.posts_count > 0  %}
              {% if tech.slug != get.technologies and tech.slug not in get.technologies and tech.slug not in get.url %}
                <li uk-filter-control=".tech-{{tech.slug}}"><a class="uk-text-capitalize" href="#">{{tech.title}}<span class="small-count uk-position-top-right">{{ (tech.posts_count < 10) ? 0 : '' }}{{tech.posts_count}}</span></a></li>
              {% endif %}
            {% endif %}
          {% endfor %}
        </ul>
      </div>
    </div>
    {% endif %}
      
    <!-- portfolio projects -->
    <section class="archive-posts uk-padding-large uk-padding-remove-horizontal uk-padding-remove-top">
      
      <!-- portfolio projects grid -->
      <div class="posts-grid uk-child-width-1-3@m uk-grid-large" uk-grid="">
        {% if archive.posts %}
          {% for post in archive.posts %}
            <article class="the-project {{(loop.index == 2 or (loop.index - 2) is divisible by(5)) ? 'uk-width-2-3@m ' : ''}} {{post.taxonomies.technologies|map(key => 'tech-' ~ key.slug)|join(' ')}}">
              <!-- tease featured -->
              {% if post.featured_img %}
                <figure class="blog-grid-image">
                  <a class="uk-inline uk-link-reset hover-grow-wrap uk-width-1-1" href="{{post.link}}">
                    <img class="uk-border-rounded uk-height-large uk-width-1-1 object-fit-cover" data-src="{{ (loop.index == 2 or (loop.index - 2) is divisible by(5)) ? post.featured_img.src|resize(900) : post.featured_img.src|resize(400) }}" data-width data-height alt="{{post.featured_img.alt}}" uk-img>
                  </a>
                </figure>
              {% endif %}
              <!-- tease title -->
              <h3 class="blog-grid-headline uk-margin-remove uk-h4">
                <a class="uk-link-heading" href="{{post.link}}">{{post.title}}.</a>
              </h3>
              <!-- tease meta -->
              {% if post.taxonomies.technologies or post.read_time %}
                <div class="post-details uk-margin uk-margin-small-top">
                  {% if post.taxonomies.technologies %}
                    <div class="technology-holder uk-inline">
                      {% for tech in post.taxonomies.technologies %}
                        {% if not loop.last %}
                          <a class="technology uk-link-reset" title="{{tech.title}}" href="{{tech.link}}">{{tech.title}}</a>,
                        {% else %}
                          <a class="technology uk-link-reset" title="{{tech.title}}" href="{{tech.link}}">{{tech.title}}</a>
                        {% endif %}
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
              {% endif %}
              <!-- tease link -->
              <a class="style-btn uk-text-capitalize uk-animation-toggle" href="{{post.link}}" tabindex="0">
                Read more <i class="fas fa-arrow-right uk-margin-small-left uk-animation-slide-left"></i>
              </a>
            </article>
          {% endfor %}
        {% else %}
          <span class="uk-text-emphasis uk-margin-large-top">No projects found here...</span>
        {% endif %}
      </div>
      
      <!-- portfolio pagination -->
      {% if (archive.pagination.next or archive.pagination.prev) %}
        <div class="archive-pagination uk-section">
          <ul class="uk-pagination">
            {% if archive.pagination.prev %}
              <li>
                <a class="prev style-btn uk-text-capitalize uk-animation-toggle" href="{{archive.pagination.prev}}" tabindex="0">
                  <i class="fas fa-arrow-left uk-margin-small-right uk-animation-slide-right"></i> Previous
                </a>
              </li>
            {% endif %}
            {% for page in archive.pagination.pages %}
              {% if page.class == 'uk-active' %}
                <li class="{{page.class}}"><span>{{page.title}}</span></li>
              {% else %}
                <li class="{{page.class}}"><a class="style-btn" href="{{page.link}}">{{page.title}}</a></li>
              {% endif %}
            {% endfor %}
            {% if archive.pagination.next %}
              <li>
                <a class="next style-btn uk-text-capitalize uk-animation-toggle" href="{{archive.pagination.next}}" tabindex="0">
                  Next <i class="fas fa-arrow-right uk-margin-small-left uk-animation-slide-left"></i>
                </a>
              </li>
            {% endif %}
          </ul>
        </div>
      {% endif %}
      
    </section>

  </div>
{% endblock %}